<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pergamino para Gaby üíú</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #d8b4fe 0%, #a21caf 100%);
      font-family: 'Quicksand', Arial, sans-serif;
      color: #533b6b;
      overflow-x: hidden;
      position: relative;
      user-select: none;
    }
    .teamo-fondo-fuera {
      pointer-events: none;
      position: fixed;
      left: 0; top: 0; width: 100vw; height: 100vh;
      z-index: 2;
      overflow: hidden;
      user-select: none;
    }
    .teamo-palabra-fondo {
      position: absolute;
      color: #a21caf;
      font-family: 'Pacifico', cursive;
      font-weight: bold;
      font-size: 1.7em;
      opacity: 0.14;
      text-shadow: 0 0 8px #d8b4fe, 0 0 2px #fff;
      white-space: nowrap;
      pointer-events: none;
      animation: teamo-flotar-fondo 8.5s linear forwards;
      user-select: none;
      will-change: transform, opacity;
    }
    @keyframes teamo-flotar-fondo {
      0%   { opacity: 0.09; transform: translateY(0px) scale(1);}
      10%  { opacity: 0.22;}
      70%  { opacity: 0.17;}
      100% { opacity: 0.05; transform: translateY(-120px) scale(1.13);}
    }
    .gif-extra-afuera {
      position: fixed;
      width: 100px;
      height: 100px;
      z-index: 3;
      opacity: 0.93;
      pointer-events: none;
      filter: drop-shadow(0 0 24px #a21caf77);
      background: none;
      animation: flotar-gif 5s ease-in-out infinite alternate;
    }
    .gif-kitty1 { right: 2vw; bottom: 2vw; animation-delay: 0s;}
    .gif-kitty2 { left: 2vw; top: 4vw; animation-delay: 2.2s;}
    .gif-kitty3 { left: 2vw; bottom: 8vw; animation-delay: 1s;}
    .gif-kitty4 { right: 3vw; top: 7vw; animation-delay: 3s;}
    .gif-kitty5 { left: 50vw; bottom: 1vw; animation-delay: 1.5s;}
    @media (max-width: 540px) {
      .gif-extra-afuera { width: 48px; height: 48px; }
      .gif-kitty1 { right: 2vw; bottom: 2vw;}
      .gif-kitty2 { left: 2vw; top: 4vw;}
      .gif-kitty3 { left: 2vw; bottom: 12vw;}
      .gif-kitty4 { right: 3vw; top: 13vw;}
      .gif-kitty5 { left: 45vw; bottom: 3vw;}
    }
    @keyframes flotar-gif {
      0% { transform: translateY(0);}
      100% { transform: translateY(-22px);}
    }
    .pergamino-bg { display: none !important; }
    .destello-carta {
      pointer-events: none;
      position: absolute;
      left: -18px; top: -18px;
      width: calc(100% + 36px);
      height: calc(100% + 36px);
      z-index: 10;
      overflow: visible;
    }
    .destello-carta svg {
      width: 100%; height: 100%;
      display: block;
      overflow: visible;
    }
    .destello-carta .destello-estrella {
      opacity: 0.98;
      transition: opacity 0.15s;
      filter: drop-shadow(0 0 18px #e0c3fc) drop-shadow(0 0 22px #a21cafcc);
    }
    .pergamino {
      position: relative;
      z-index: 4;
      max-width: 510px;
      margin: 70px auto 35px auto;
      padding: 55px 34px 55px 34px;
      background: linear-gradient(135deg, #e9d5ff 0%, #f8e8ff 70%, #c4b5fd 100%);
      border-radius: 44px 44px 35px 35px / 49px 49px 38px 38px;
      box-shadow: 0 20px 80px #cabffd77, 0 0 0 16px #e8d7fdcc inset, 0 0 0 3px #a78bfa88 inset;
      border: 10px solid #e0c3fcbb;
      border-top: 22px solid #c026d3bb;
      border-bottom: 32px solid #c026d3bb;
      text-align: center;
      transition: box-shadow 0.6s;
      overflow: visible;
      animation: aparecer-pergamino 1.7s cubic-bezier(.42,0,.23,1.29);
      position: relative;
    }
    @keyframes aparecer-pergamino {
      0% {opacity:0; transform: scale(.72) translateY(140px);}
      80% {opacity:.93;}
      100% {opacity:1; transform: scale(1) translateY(0);}
    }
    .mensaje {
      margin: 21px 0 22px 0;
      font-size: 1.19em;
      color: #533b6b;
      line-height: 1.77;
      letter-spacing: 0.8px;
      background: 
        repeating-linear-gradient(
          to bottom, 
          #a21caf12 0px, #a21caf22 2px, transparent 2px, transparent 36px
        ),
        rgba(236, 72, 153, 0.028);
      border-radius: 18px;
      padding: 20px 18px 18px 18px;
      box-shadow: 0 1.5px 8px #a21caf18, 0 0px 28px #c026d335;
      border-left: 5px solid #a78bfa;
      border-right: 5px solid #f5d0fe;
      font-family: 'Quicksand', Arial, sans-serif;
      font-weight: 500;
      min-height: 120px;
      transition: background 0.8s, color 0.6s;
      position: relative;
      z-index: 4;
      overflow: visible;
    }
    .mensaje strong, .mensaje b {
      color: #a21caf;
      font-weight: bold;
      text-shadow: 0 0 8px #f3e8ff;
    }
    .firma {
      margin-top: 25px;
      font-family: 'Pacifico', cursive;
      color: #a21caf;
      font-size: 1.17em;
      text-align: right;
      opacity: 0.8;
      letter-spacing: 1.7px;
      margin-right: 11px;
    }
    .boton-cambiar, .boton-final-carta {
      margin-top: 23px;
      padding: 13px 38px 13px 38px;
      font-size: 1.22em;
      border: none;
      border-radius: 23px;
      background: linear-gradient(90deg, #a78bfa 20%, #f3e8ff 65%, #9333ea 100%);
      color: #7c3aed;
      cursor: pointer;
      font-family: 'Pacifico', cursive;
      font-weight: bold;
      letter-spacing: 2px;
      box-shadow: 0 2px 16px #a78bfa70, 0 6px 32px #f3e8ff40;
      transition: background 0.21s, transform 0.17s, color 0.22s;
      outline: 2px solid #c026d3;
      outline-offset: 2px;
      z-index: 20;
      position: relative;
      overflow: hidden;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
    }
    .boton-cambiar span, .boton-final-carta span {
      position: relative; z-index: 2;
      display: inline-block;
      vertical-align: middle;
    }
    .boton-cambiar .boton-burbuja {
      position: absolute;
      width: 15px; height: 15px;
      background: radial-gradient(circle, #f3e8ff 70%, #a78bfa 100%);
      border-radius: 50%;
      left: 50%; top: 50%;
      transform: translate(-50%, -50%) scale(0);
      opacity: 0.7;
      pointer-events: none;
      z-index: 1;
      animation: boton-burbuja-pop 0.6s forwards;
    }
    @keyframes boton-burbuja-pop {
      0% { transform: translate(-50%, -50%) scale(0);}
      65% { transform: translate(-50%, -50%) scale(2.2);}
      100% { transform: translate(-50%, -50%) scale(2.6); opacity:0;}
    }
    .boton-cambiar:hover, .boton-cambiar:focus,
    .boton-final-carta:hover, .boton-final-carta:focus {
      background: linear-gradient(90deg, #c026d3 0%, #f3e8ff 70%, #7c3aed 100%);
      transform: scale(1.07) rotate(-2deg);
      color: #a21caf;
    }
    .gif-boton {
      width: 32px;
      height: 32px;
      margin-left: 2px;
      margin-right: -6px;
      border-radius: 50%;
      object-fit: cover;
      background: #fff8;
      display: inline-block;
      vertical-align: middle;
      pointer-events: none;
    }
    .corazon-morado {
      font-size: 1.5em;
      margin-left: 8px;
      margin-right: -7px;
      vertical-align: middle;
      filter: drop-shadow(0 0 8px #a21caf88);
      animation: latir 1.1s infinite;
      display: inline-block;
    }
    @keyframes latir {
      0%,100%{ transform: scale(1);}
      20%{ transform: scale(1.21);}
      40%{ transform: scale(0.97);}
      60%{ transform: scale(1.14);}
      80%{ transform: scale(0.97);}
    }
    .animacion-fondo { pointer-events: none; position: fixed; width: 100vw; height: 100vh; top: 0; left: 0; z-index: 2; overflow: hidden; }
    .burbuja, .corazon-flotante {
      position: absolute;
      border-radius: 50%;
      pointer-events: none;
    }
    .burbuja {
      background: radial-gradient(circle, #f3e8ff 75%, #a78bfa 100%);
      opacity: 0.19;
      animation: subir-burbuja 7s linear forwards;
    }
    @keyframes subir-burbuja {
      from {transform: translateY(0);}
      to {transform: translateY(-110vh);}
    }
    .corazon-flotante {
      width: 36px; height: 36px;
      background: none;
      font-size: 2em;
      color: #d946ef;
      filter: drop-shadow(0 0 16px #f5d0fecc);
      animation: subir-corazon 6.3s linear forwards;
      opacity: 0.8;
      text-align: center;
      line-height: 36px;
      z-index: 22;
      user-select: none;
      will-change: transform, opacity;
    }
    @keyframes subir-corazon {
      from {transform: translateY(0);}
      to {transform: translateY(-115vh) scale(1.18);}
    }
    .brillo {
      position: absolute;
      width: 16px; height: 16px;
      background: radial-gradient(circle, #fff 0%, #f5d0fe 85%);
      border-radius: 50%;
      opacity: 0.44;
      animation: brillar 2.6s infinite alternate;
      filter: blur(1.8px);
    }
    @keyframes brillar {
      0% { opacity: .33; transform: scale(0.88);}
      70% { opacity: .67; transform: scale(1.15);}
      100% { opacity: .31; transform: scale(0.8);}
    }
    .huellas {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 0 auto 18px auto;
    }
    .huella {
      width: 38px;
      height: 38px;
      filter: drop-shadow(0 2px 7px #a21caf77);
      animation: brincarH 2.3s cubic-bezier(.44,-0.14,.6,1.23) infinite alternate;
    }
    .huella2 { animation-delay: .9s; }
    /* .huella3 { animation-delay: 1.3s; } -- ELIMINADA */
    @keyframes brincarH {
      0% { transform: scale(0.95) translateY(0);}
      60% { transform: scale(1.10) translateY(-9px);}
      100% { transform: scale(0.97) translateY(0);}
    }
    .gif-huella {
      width: 48px;
      height: 48px;
      display: block;
      margin: 0 auto 12px auto;
      border-radius: 50%;
      box-shadow: 0 1px 10px #a21caf55;
      background: #fff8;
      border: 2.5px solid #e0c3fc;
      animation: gifpop 1.7s cubic-bezier(.4,1.7,.7,.7);
      z-index: 5;
      position: relative;
    }
    .gif-centro, .gif-centro-peq, .gif-final {
      margin: 18px auto 0 auto;
      display: block;
      max-width: 120px;
      max-height: 120px;
      border-radius: 16px;
      background: none !important;
      box-shadow: none !important;
      border: none !important;
      animation: gifpop 1.2s cubic-bezier(.4,1.7,.7,.7);
    }
    .gif-centro-peq { max-width: 95px; max-height: 80px; margin-top: 12px;}
    .gif-final { margin-top: 24px; max-width: 120px; max-height: 120px; border-radius: 20px;}
    @keyframes gifpop {
      0% {opacity:0; transform:scale(0.7);}
      60% {opacity:.86;}
      100% {opacity:1; transform:scale(1);}
    }
    .detalle-morado,
    .cat-on-roll,
    .cat-on-roll2 { display: none !important; }
    .rollo-top, .rollo-bottom {
      position: absolute;
      left: 50%; transform: translateX(-50%);
      width: 140px; height: 37px;
      background: radial-gradient(circle at 60% 50%, #d8b4fe 60%, #ede9fe 100%);
      border-radius: 40px 40px 20px 20px / 36px 36px 10px 10px;
      z-index: 5;
      filter: drop-shadow(0 2px 7px #a78bfa66);
    }
    .rollo-top { top: -49px; border-bottom: 7px solid #c026d3cc; }
    .rollo-bottom { bottom: -53px; border-top: 7px solid #c026d3cc; transform: translateX(-50%) scaleY(-1);}
    @media (max-width: 540px) {
      .pergamino {max-width: 97vw; padding: 5vw 2vw 15vw 2vw;}
      h1 {font-size: 1.15em;}
      .huella {width: 22px; height: 22px;}
      .gif-huella {width: 28px; height: 28px;}
      .gif-centro,.gif-centro-peq,.gif-final {max-width: 65vw; max-height: 70vw;}
      .rollo-top,.rollo-bottom{width: 81px;}
      .gif-boton {width: 22px; height: 22px;}
    }
  </style>
</head>
<body>
  <div class="teamo-fondo-fuera" id="teamoFondoFuera"></div>
  <img src="https://i.gifer.com/7V0.gif" class="gif-extra-afuera gif-kitty1" alt="gif decorativo extra" draggable="false" />
  <img src="https://i.gifer.com/7V0.gif" class="gif-extra-afuera gif-kitty2" alt="gif decorativo extra" draggable="false" />
  <img src="https://i.gifer.com/7V0.gif" class="gif-extra-afuera gif-kitty3" alt="gif decorativo extra" draggable="false" />
  <img src="https://i.gifer.com/7V0.gif" class="gif-extra-afuera gif-kitty4" alt="gif decorativo extra" draggable="false" />
  <img src="https://i.gifer.com/7V0.gif" class="gif-extra-afuera gif-kitty5" alt="gif decorativo extra" draggable="false" />
  <div class="pergamino-bg"></div>
  <div class="animacion-fondo" id="burbujas"></div>
  <div class="animacion-fondo" id="brillos"></div>
  <div class="animacion-fondo" id="corazones"></div>
  <div class="pergamino" id="pergaminoCarta">
    <div class="destello-carta" id="destelloCarta"></div>
    <div class="rollo-top"></div>
    <img class="gif-huella" src="https://i.gifer.com/19wO.gif" alt="Gif animado de patita" />
    <div class="huellas">
      <svg class="huella" viewBox="0 0 60 60">
        <ellipse cx="30" cy="40" rx="13" ry="16" fill="#a21caf"/>
        <ellipse cx="14" cy="30" rx="5" ry="8" fill="#d8b4fe"/>
        <ellipse cx="46" cy="30" rx="5" ry="8" fill="#d8b4fe"/>
        <ellipse cx="21" cy="17" rx="4" ry="7" fill="#d8b4fe"/>
        <ellipse cx="39" cy="17" rx="4" ry="7" fill="#d8b4fe"/>
      </svg>
      <svg class="huella huella2" viewBox="0 0 60 60">
        <ellipse cx="30" cy="40" rx="13" ry="16" fill="#a21caf"/>
        <ellipse cx="14" cy="30" rx="5" ry="8" fill="#d8b4fe"/>
        <ellipse cx="46" cy="30" rx="5" ry="8" fill="#d8b4fe"/>
        <ellipse cx="21" cy="17" rx="4" ry="7" fill="#d8b4fe"/>
        <ellipse cx="39" cy="17" rx="4" ry="7" fill="#d8b4fe"/>
      </svg>
    </div>
    <h1 id="tituloCarta"></h1>
    <div id="mensaje" class="mensaje"></div>
    <div id="gifExtra"></div>
    <div class="firma" id="firma"></div>
    <button class="boton-cambiar" id="btnCambiar">
      <span></span>
      <img src="https://i.gifer.com/XOsX.gif" alt="gif decorativo" class="gif-boton" />
    </button>
    <a href="https://www.youtube.com/watch?v=qkOzPSaW61o" target="_blank" class="boton-final-carta" id="btnFinalCarta" style="display:none;">
      <span>Presiona aqu√≠</span>
      <span class="corazon-morado">üíú</span>
    </a>
    <button class="boton-cambiar" id="btnInicio" style="display:none;">
      <span>Volver al inicio</span>
      <img src="https://i.gifer.com/XOsX.gif" alt="gif decorativo" class="gif-boton" />
    </button>
    <div class="rollo-bottom"></div>
  </div>
  <audio id="audioLove" src="https://cdn.pixabay.com/audio/2022/02/23/audio_115b9b32b2.mp3"></audio>
  <script>
    // Palabras TE AMO flotando en el fondo FUERA de la carta
    function spawnTeAmoFondoFuera() {
      const cont = document.getElementById('teamoFondoFuera');
      if (!cont) return;
      if (cont.childNodes.length > 80) cont.innerHTML = '';
      const palabra = document.createElement('span');
      palabra.className = 'teamo-palabra-fondo';
      palabra.textContent = 'TE AMO';
      palabra.style.left = (Math.random() * 95) + 'vw';
      palabra.style.top = (Math.random() * 70 + 20) + 'vh';
      palabra.style.fontSize = (Math.random() * 2.3 + 1.1) + 'em';
      palabra.style.opacity = (Math.random() * 0.16 + 0.09).toFixed(2);
      palabra.style.transform = `rotate(${Math.random()*34-17}deg)`;
      const dur = (Math.random() * 4.5 + 7).toFixed(2);
      palabra.style.animationDuration = dur + 's';
      palabra.style.animationDelay = (Math.random()*2.2).toFixed(2)+'s';
      if (Math.random() > 0.5) palabra.style.color = "#c026d3";
      if (Math.random() > 0.7) palabra.style.color = "#9333ea";
      if (Math.random() > 0.82) palabra.style.color = "#f472b6";
      if (Math.random() > 0.94) palabra.style.color = "#a21caf";
      cont.appendChild(palabra);
      setTimeout(()=>{ if(palabra.parentNode) palabra.parentNode.removeChild(palabra); }, dur*1000 + 4000);
      setTimeout(spawnTeAmoFondoFuera, Math.random()*220+100);
    }
    setTimeout(spawnTeAmoFondoFuera, 600);

    // -- MENSAJES ADAPTADOS PARA AMOR A DISTANCIA, REALES Y CON APODOS TIERNOS --
    const gifs = [
      { html: '<img src="https://i.gifer.com/YC7t.gif" alt="Gif tierno" class="gif-centro" />' },
      { html: '<img src="https://i.gifer.com/NRI0.gif" alt="Gif coraz√≥n" class="gif-centro-peq" />' },
      { html: '<img src="https://i.gifer.com/7V0.gif" alt="Gif abrazo" class="gif-centro-peq" />' },
      { html: '<img src="https://i.gifer.com/YC7t.gif" alt="Gif tierno" class="gif-centro-peq" />' },
      { html: '<img src="https://i.gifer.com/NRI0.gif" alt="Gif coraz√≥n final" class="gif-final" />' }
    ];
    const fases = [
      {
        titulo: "Un rinc√≥n especial solo para ti, mi Gabys üíú",
        mensaje: `
          <b>Mi amorcito,</b><br>
          Aunque la distancia a veces pese, t√∫ haces que cada d√≠a tenga sentido.<br>
          No importa cu√°ntos problemas o discusiones tengamos, siempre encuentro razones para amarte m√°s y nunca rendirme contigo.<br>
          Eres mi chiquita, mi pastelito, la ni√±a de mis ojos y la persona m√°s importante para m√≠.<br>
          <span style="color:#a21caf;">Haz clic para seguir leyendo, mi Gabys.</span>
        `,
        firma: "Siempre tuyo",
        fondo: "burbujas",
        boton: "Siguiente sorpresa ‚ú®",
        gifExtra: 0
      },
      {
        titulo: "Nada es imposible si estamos juntos",
        mensaje: `
          <b>Mi pastelito,</b><br>
          Hemos pasado por momentos dif√≠ciles y a veces parece que el mundo est√° en nuestra contra.<br>
          Pero s√© que todo lo que vivimos, bueno o malo, nos hace m√°s fuertes como pareja.<br>
          No importa cu√°ntos kil√≥metros nos separen, yo siempre estar√© aqu√≠ para ti y por ti.<br>
          <span style="color:#7c3aed;">Haz clic para continuar, mi amorcito üíú</span>
        `,
        firma: "Con todo mi coraz√≥n",
        fondo: "brillos",
        boton: "Ver m√°s magia üí´",
        gifExtra: 1
      },
      {
        titulo: "Mi chiquita, eres mi mayor sue√±o",
        mensaje: `
          <b>Mi amor,</b><br>
          A veces discutimos, a veces no nos entendemos, pero el amor que siento por ti siempre gana.<br>
          Sue√±o con el d√≠a que estemos juntos y podamos mirar atr√°s, sabiendo que superamos todo.<br>
          No cambiar√≠a nada de lo que hemos vivido porque todo me llev√≥ a amarte como te amo hoy.<br>
          <span style="color:#c026d3;">Haz clic para seguir, mi ni√±a de ojos bonitos üíú</span>
        `,
        firma: "Tu eterno enamorado",
        fondo: "burbujas",
        boton: "Otra sorpresa üêæ",
        gifExtra: 2
      },
      {
        titulo: "Siempre ser√°s la ni√±a de mis ojos",
        mensaje: `
          <b>Mi Gabys,</b><br>
          Si alguna vez tienes dudas, recuerda que te amo mucho, much√≠simo, y que siempre ser√°s la ni√±a de mis ojos.<br>
          Pase lo que pase, quiero luchar por nosotros y cumplir todos nuestros sue√±os juntos.<br>
          Eres mi amorcito, mi compa√±era y mi destino.<br>
          <span style="color:#a21caf;">Haz clic para el mensaje final, mi chiquita...</span>
        `,
        firma: "Te amo siempre",
        fondo: "brillos",
        boton: "√öltima sorpresa üíú",
        gifExtra: 3
      },
      {
        titulo: "Todo valdr√° la pena, mi Gabys",
        mensaje: `
          <b>Mi amorcito,</b><br>
          No importa la distancia ni los problemas. S√© que vamos a lograrlo y cumplir todo lo que so√±amos.<br>
          Eres y siempre ser√°s mi ni√±a de los ojitos lindos, mi pastelito, mi chiquita y el gran amor de mi vida.<br>
          Gracias por nunca rendirte y por darme razones para seguir creyendo en nosotros.<br>
          <span style="color:#7c3aed;">Presiona aqu√≠ para una √∫ltima sorpresa, mi Gabys üíú</span>
        `,
        firma: "Siempre tuyo, te amo mucho mucho mucho",
        fondo: "burbujas",
        boton: "Presiona aqu√≠",
        gifExtra: 4
      }
    ];
    let estado = 0;
    function renderCarta() {
      document.getElementById('tituloCarta').innerHTML = fases[estado].titulo;
      document.getElementById('mensaje').innerHTML = fases[estado].mensaje;
      document.getElementById('firma').textContent = fases[estado].firma;
      document.getElementById('burbujas').style.display = fases[estado].fondo === "burbujas" ? "block" : "none";
      document.getElementById('brillos').style.display = fases[estado].fondo === "brillos" ? "block" : "none";
      document.getElementById('gifExtra').innerHTML = gifs[fases[estado].gifExtra].html;
      const btnSig = document.getElementById('btnCambiar');
      const btnInicio = document.getElementById('btnInicio');
      const btnFinal = document.getElementById('btnFinalCarta');
      if (estado < fases.length - 1) {
        btnSig.style.display = "";
        btnSig.querySelector("span").textContent = fases[estado].boton;
        btnInicio.style.display = "none";
        btnFinal.style.display = "none";
      } else {
        btnSig.style.display = "none";
        btnInicio.style.display = "none";
        btnFinal.style.display = "";
      }
    }
    document.getElementById('btnCambiar').onclick = function(e){
      if (estado < fases.length - 1) {
        estado += 1;
        renderCarta();
        document.getElementById('audioLove').play();
        let btn = e.currentTarget;
        let bubble = document.createElement("span");
        bubble.className = "boton-burbuja";
        btn.appendChild(bubble);
        setTimeout(()=>bubble.remove(), 600);
      }
    };
    document.getElementById('btnInicio').onclick = function() {
      estado = 0;
      renderCarta();
      document.getElementById('audioLove').play();
    };
    function animateDestelloCarta() {
      const carta = document.getElementById('pergaminoCarta');
      const destelloDiv = document.getElementById('destelloCarta');
      const w = carta.offsetWidth + 36;
      const h = carta.offsetHeight + 36;
      const r = 45;
      const path = `
        M ${r},0
        H ${w-r}
        Q ${w},0 ${w},${r}
        V ${h-r}
        Q ${w},${h} ${w-r},${h}
        H ${r}
        Q 0,${h} 0,${h-r}
        V ${r}
        Q 0,0 ${r},0
        Z
      `;
      destelloDiv.innerHTML = '';
      const svgNS = "http://www.w3.org/2000/svg";
      const svg = document.createElementNS(svgNS, "svg");
      svg.setAttribute("width", w);
      svg.setAttribute("height", h);
      svg.setAttribute("viewBox", `0 0 ${w} ${h}`);
      svg.style.position = "absolute";
      svg.style.top = "0";
      svg.style.left = "0";
      const pathElem = document.createElementNS(svgNS, "path");
      pathElem.setAttribute("d", path);
      pathElem.setAttribute("fill", "none");
      pathElem.setAttribute("stroke", "none");
      svg.appendChild(pathElem);
      // Estrella SVG
      const estrella = document.createElementNS(svgNS, "polygon");
      estrella.setAttribute("points", starPoints(12, 5));
      estrella.setAttribute("fill", "url(#gradMorado)");
      estrella.setAttribute("class", "destello-estrella");
      estrella.setAttribute("opacity", "1");
      const grad = document.createElementNS(svgNS, "radialGradient");
      grad.setAttribute("id", "gradMorado");
      grad.setAttribute("cx", "50%");
      grad.setAttribute("cy", "50%");
      grad.setAttribute("r", "55%");
      grad.innerHTML = `<stop offset="0%" stop-color="#fff" stop-opacity="1"/><stop offset="70%" stop-color="#a21caf" stop-opacity="0.7"/><stop offset="100%" stop-color="#a21caf" stop-opacity="0"/>`;
      svg.appendChild(grad);
      svg.appendChild(estrella);
      destelloDiv.appendChild(svg);
      let len = pathElem.getTotalLength();
      let t = 0, duration = 4500;
      function loop() {
        t = (performance.now() % duration) / duration;
        let pos = pathElem.getPointAtLength(t * len);
        estrella.setAttribute("transform", `translate(${pos.x},${pos.y}) rotate(${t*360})`);
        requestAnimationFrame(loop);
      }
      loop();
    }
    function starPoints(r1, r2) {
      let points = [];
      let cx = 0, cy = 0, n = 5;
      for (let i = 0; i < 2 * n; i++) {
        let angle = Math.PI / n * i;
        let r = i % 2 === 0 ? r1 : r2;
        let x = cx + Math.cos(angle - Math.PI / 2) * r;
        let y = cy + Math.sin(angle - Math.PI / 2) * r;
        points.push(`${x},${y}`);
      }
      return points.join(" ");
    }
    window.addEventListener('resize', function(){ setTimeout(animateDestelloCarta, 300); });
    function animarBurbujas() {
      const burb = document.getElementById('burbujas');
      for(let i=0;i<13;i++) {
        let b = document.createElement('div');
        b.className = 'burbuja';
        b.style.left = Math.random()*97+'vw';
        b.style.bottom = '-30px';
        b.style.width = b.style.height = (Math.random()*22+17)+'px';
        b.style.animationDuration = (Math.random()*2.5+5.2)+'s';
        b.style.opacity = (Math.random()*0.12+0.18).toFixed(2);
        burb.appendChild(b);
        setTimeout(()=>b.remove(), 7500);
      }
      setTimeout(animarBurbujas, 3100);
    }
    function animarBrillos() {
      const br = document.getElementById('brillos');
      br.innerHTML = '';
      for(let i=0; i<13; i++) {
        let s = document.createElement('div');
        s.className = 'brillo';
        s.style.top = Math.random()*92 + '%';
        s.style.left = Math.random()*98 + '%';
        s.style.width = s.style.height = (Math.random()*13+8)+'px';
        s.style.animationDuration = (Math.random()*1.7+2.2)+'s';
        br.appendChild(s);
      }
      setTimeout(animarBrillos, 3200);
    }
    function animarCorazones() {
      const corazones = document.getElementById('corazones');
      for(let i=0;i<24;i++) {
        let heart = document.createElement('div');
        heart.className = 'corazon-flotante';
        heart.textContent = ["üíú","üíü","üíñ","üíó","üíù"][Math.floor(Math.random()*5)];
        heart.style.left = (Math.random()*92+2)+'vw';
        heart.style.bottom = '-30px';
        heart.style.fontSize = (Math.random()*1.2+1.35)+'em';
        heart.style.animationDelay = (Math.random()*4)+'s';
        corazones.appendChild(heart);
        setTimeout(()=>heart.remove(), 7300+Math.random()*700);
      }
      setTimeout(animarCorazones, 3000);
    }
    animarBurbujas();
    animarBrillos();
    document.getElementById('brillos').style.display = 'none';
    animarCorazones();
    renderCarta();
    setTimeout(animateDestelloCarta, 400);
    const observer = new MutationObserver(() => { animateDestelloCarta(); });
    observer.observe(document.getElementById('pergaminoCarta'), {childList:true, subtree:false});
  </script>
</body>
</html>
